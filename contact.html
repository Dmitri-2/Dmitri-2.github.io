<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="utf-8">
    <title>Dmitri Murphy</title>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
            crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
            integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
            crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css?family=M+PLUS+Rounded+1c|Nunito|Raleway|Reenie+Beanie|Roboto|Sacramento&display=swap"
          rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link href="main.css" rel="stylesheet" type="text/css">
    <link href="subpageStyles.css" rel="stylesheet" type="text/css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css"
          integrity="sha384-gfdkjb5BdAXd+lj+gudLWI+BXq4IuLW5IT+brZEZsLFm++aCMlF1V92rMkPaX4PP" crossorigin="anonymous">
</head>
<body>
<header>
    <nav class="navbar navbar-dark navbar-expand-lg bg-custom-header">
        <a class="navbar-brand" href="index.html"> Personal Portfolio </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navContent">
            <span class="navbar-toggler-icon"> </span>
        </button>
        <div class="collapse navbar-collapse" id="navContent">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item px-3">
                    <a class="nav-link text-slate-light" href="about.html"> About </a>
                </li>
                <li class="nav-item px-3">
                    <a class="nav-link text-slate-light" href="projects.html"> Projects </a>
                </li>
                <li class="nav-item px-3">
                    <a class="nav-link text-slate-light active" href="contact.html"> Contact </a>
                </li>
            </ul>
        </div>
    </nav>
</header>

<div class="subpage-content h-100">
    <div id="main-container" class="container">
        <div class="row">
            <div class="col-md-6">
                <h1 class="text-muted-red font-80"> Let's talk! </h1>
                <h3 class="text-olive">
                    Any thoughts?
                </h3>
            </div>
            <div class="col-md-6 mt-5 mt-md-0">
                <div class="card h-100">
                    <h1 class="text-center"> Contact Form</h1>

                    <div id="success-message" class="p-5 text-center hidden">
                        <h3>Message Sent <i class="fas fa-check text-success"></i></h3>
                        <button id="send-another-btn" class="btn btn-lg btn-secondary mt-5">Send Another Message
                        </button>
                    </div>

                    <form id="main-form">
                        <div class="form-group">
                            <h5 class="mb-0"><label for="contact-name"> Name </label></h5>
                            <input id="contact-name" name="contact-name" class="form-control" type="text"
                                   placeholder="Name">
                        </div>
                        <div class="form-group">
                            <h5 class="mb-0"><label for="contact-email"> Email </label></h5>
                            <input id="contact-email" name="contact-email" class="form-control" type="email"
                                   placeholder="example@email.com">
                        </div>
                        <div class="form-group">
                            <h5 class="mb-0"><label for="contact-subject"> Subject </label></h5>
                            <input id="contact-subject" name="contact-subject" class="form-control" type="email"
                                   placeholder="Topic">
                        </div>
                        <div class="form-group">
                            <h5 class="mb-0"><label for="contact-message"> Message </label></h5>
                            <textarea id="contact-message" name="contact-message" class="form-control"
                                      rows="5"></textarea>
                        </div>
                        <div class="d-flex mt-4">
                            <button id="form-submit-btn" type="button"
                                    class="btn btn-lg btn-dark bg-muted-red no-border mx-auto"> Send Message
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>


<footer class="navbar navbar-light bg-light mt-5">
    <div class="navar-nav d-flex justify-content-between w-100">
        <div class="nav-item nav-link"> Made with Bootstrap, FontAwesome and jQuery</div>
        <div class="nav-item nav-link"> Background Photo: Eberhard Grossgasteiger (Unsplash)</div>
    </div>
</footer>
</body>

<script>
    var formShown = true;
    $("#form-submit-btn").click(handleFormSubmission);
    $("#send-another-btn").click(switchDisplay);
    const endpoint = "https://web.cecs.pdx.edu/~murphyd/mailme.php";
    const nameElement = $("#contact-name");
    const emailElement = $("#contact-email");
    const topicElement = $("#contact-subject");
    const messageElement = $("#contact-message");

    function handleFormSubmission() {
        let emailSubject = nameElement.val() + ": " + topicElement.val();
        let paylod = {
            "from": emailElement.val(),
            "subject": emailSubject,
            "message": messageElement.val()
        };

        console.log(paylod);
        $.post(endpoint, paylod, function (response, status) {
            response = JSON.parse(response);
            if (response["result"] === "bad_email") {
                alert("Looks like the email you typed in contains an error!");
            }
            else if (response["result"] === "sent") {
                switchDisplay();
                clearForm();
            }
            else {
                alert("Something went wrong. Sorry!")
            }
        });


    }

    function switchDisplay() {
        if (formShown) {
            $("#main-form").hide();
            $("#success-message").show();
            formShown = false;
        } else {
            $("#main-form").show();
            $("#success-message").hide();
            formShown = true;
        }
    }

    function clearForm() {
        nameElement.val("");
        emailElement.val("");
        topicElement.val("");
        messageElement.val("");
    }

</script>

</html>